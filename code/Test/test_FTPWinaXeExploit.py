import unittest
import unittest.mock as mock

from Test.GenericTest import GenericTest

sha_one_attacker_ftp = 'd43ebfd5b0f3c9b6556e6a8d2ae4da4d334ed673881d67720eda16faab1b498e'

"""
Name                             Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------------------------
Attack/FTPWinaXeExploit.py         141     14    90%   55, 66, 71, 121-122, 148-150, 208-214
"""


class UnitTestFTPWinaXeExploit(GenericTest):

    @mock.patch('ID2TLib.Utility.get_rnd_x86_nop')
    @mock.patch('ID2TLib.Utility.get_rnd_bytes')
    def test_one_attacker_ftp(self, mock_rnd_x86_nop, mock_rnd_bytes):
        mock_rnd_x86_nop.return_value = b''
        mock_rnd_bytes.return_value = b''
        self.generic_test([['FTPWinaXeExploit']], sha_one_attacker_ftp)


if __name__ == '__main__':
    unittest.main()
